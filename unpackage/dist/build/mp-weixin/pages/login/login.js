(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"17ff":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("20fc"));function a(e){return e&&e.__esModule?e:{default:e}}var i=function(){n.e("components/bind-mobile").then(function(){return resolve(n("b4b2"))}.bind(null,n)).catch(n.oe)},u={components:{bindMobile:i},mixins:[o.default],data:function(){return{isPhone:!1,canIUseGetUserProfile:!1,checked:!1}},onLoad:function(){e.login({success:function(e){console.log("888",e.code)}});wx.getUserProfile&&(this.canIUseGetUserProfile=!0)},methods:{goAgreement:function(t){e.navigateTo({url:"/otherpages/agreement/agreement?type="+t})},login:function(t){var n=this;this.canIUseGetUserProfile?wx.getUserProfile({desc:"获取用户个人信息",success:function(t){"getUserProfile:ok"==t.errMsg&&(n.authInfo.avatarUrl=t.userInfo.avatarUrl,n.authInfo.nickName=t.userInfo.nickName,e.setStorageSync("authInfo",n.authInfo),n.getCode((function(e){e&&n.authLogin(e)})))}}):"getUserInfo:ok"==t.detail.errMsg&&this.getCode((function(e){e&&n.authLogin(e)}))},authLogin:function(t){var n=this;e.showLoading({title:"登录中"}),e.setStorage({key:"authInfo",data:t}),this.$api.sendRequest({url:"/addons/shop/api.login/wxLogin",data:t,success:function(t){1==t.code?t.data.user?(e.setStorage({key:"token",data:t.data.user.token,success:function(){e.removeStorageSync("authInfo"),e.removeStorageSync("is_new"),n.$store.commit("setToken",t.data.token),n.getMemberInfo()}}),setTimeout((function(){e.hideLoading(),e.navigateBack({delta:1})}),1e3)):(e.hideLoading(),n.$refs.bindMobile.open()):(e.hideLoading(),n.$util.showToast({title:"登录失败"}))},fail:function(){e.hideLoading(),n.$util.showToast({title:"登录失败"})}})},getMemberInfo:function(){this.$api.sendRequest({url:"/api/index.user/userInfo",data:{},success:function(t){t.code>=1&&e.setStorageSync("userInfo",t.data)}})}}};t.default=u}).call(this,n("543d")["default"])},"7ca5":function(e,t,n){"use strict";var o=n("d8a1"),a=n.n(o);a.a},8250:function(e,t,n){"use strict";n.r(t);var o=n("97de"),a=n("90e2");for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("7ca5");var u,r=n("f0c5"),c=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],u);t["default"]=c.exports},"90e2":function(e,t,n){"use strict";n.r(t);var o=n("17ff"),a=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"97de":function(e,t,n){"use strict";var o;n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var a=function(){var e=this,t=e.$createElement;e._self._c},i=[]},c7ac:function(e,t,n){"use strict";(function(e){n("1cde");o(n("66fd"));var t=o(n("8250"));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},d8a1:function(e,t,n){}},[["c7ac","common/runtime","common/vendor"]]]);