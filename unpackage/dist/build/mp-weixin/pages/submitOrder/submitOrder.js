(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/submitOrder/submitOrder"],{"0b63":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){n.e("components/expense-detail/expense-detail").then(function(){return resolve(n("4d38"))}.bind(null,n)).catch(n.oe)},o=function(){n.e("components/choose-driver/choose-driver").then(function(){return resolve(n("d99c"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("components/coin-pop/coin-pop").then(function(){return resolve(n("df0f"))}.bind(null,n)).catch(n.oe)},a={components:{coinPop:s,chooseDriver:o,expenseDetail:i},data:function(){return{show:!1,showDriver:!1,showExpense:!1,payRadio:0,secureIndex:"",secure_id:0,insure:0,secureList:[],id:0,detail:"",driverList:[],driver_id:0,pickupdate:{startDate:"",endDate:"",startDate1:"",endDate1:"",startTime:"14:00",endTime:"14:00",dayNum:1},location:"",storeInfo:"",score:0,score_rate:0,score_money:0,remark:"",coupon:{num:0,jian_zhe:0,coupon_name:"",coupon_id:""},settlement:{amount:0,saleamount:0,yuyuemoney:0,zuche_deposit:0,weizhang_deposit:0,insure:0,sever_money:0,coupon_money:0},songhuan_type:"自助取还"}},filters:{getDateWeek:function(e){var t=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],n=new Date(Date.parse(e));return t[n.getDay()]}},onLoad:function(t){this.id=t.id,e.getStorageSync("pickupdate")&&(this.pickupdate=e.getStorageSync("pickupdate")),e.getStorageSync("storeInfo")&&(this.storeInfo=e.getStorageSync("storeInfo")),e.getStorageSync("coin_rate")&&(this.score_rate=e.getStorageSync("coin_rate")),this.getMemberInfo(),this.getDetail(),this.getCalacOrder(),this.getAbleCoupon(),this.getSecureService()},onShow:function(){if(e.getStorageSync("coupon")){var t=e.getStorageSync("coupon");this.coupon=Object.assign(this.coupon,t),this.getCalacOrder()}e.getStorageSync("location")&&(this.location=e.getStorageSync("location")),this.getDriverList()},onUnload:function(){e.removeStorageSync("coupon")},methods:{chooseLocation:function(){this.$util.redirectTo("/otherpages/chooseAddress/chooseAddress")},getDetail:function(){var e=this;this.$api.sendRequest({url:"/api/car/Index/cardateils",data:{id:this.id},success:function(t){t.code>=1?(e.detail=t.data,e.$refs.loadingCover&&e.$refs.loadingCover.hide()):e.$refs.loadingCover&&e.$refs.loadingCover.hide()}})},goAgree:function(e){this.$util.redirectTo("/pages/agree/agree?type="+e)},getMemberInfo:function(){var t=this;this.$api.sendRequest({url:"/api/index.user/userInfo",data:{},success:function(n){if(n.code>=1){t.score=n.data.score,e.setStorageSync("userInfo",n.data);var i=parseInt(t.score/t.score_rate);t.score_money=i}}})},getSecureService:function(){var e=this;this.$api.sendRequest({url:"/api/car/Index/guarantee",data:{},success:function(t){1==t.code&&t.data.length&&(e.secureList=t.data)}})},goChooseCoupon:function(){var e=this.pickupdate.startDate+" "+this.pickupdate.startTime,t=this.pickupdate.endDate+" "+this.pickupdate.endTime,n={start_time:e,end_time:t,motorcycle_id:this.id};this.$util.redirectTo("/otherpages/useCoupon/useCoupon?params="+JSON.stringify(n))},getAbleCoupon:function(){var e=this,t=this.pickupdate.startDate+" "+this.pickupdate.startTime,n=this.pickupdate.endDate+" "+this.pickupdate.endTime;this.$api.sendRequest({url:"/api/coupon/Index/chackCarcoupon",data:{start_time:t,end_time:n,motorcycle_id:this.id},success:function(t){t.code>=1&&(t.data.length?(e.coupon.num=t.data.length,e.coupon.jian_zhe=t.data[0].jian_zhe,e.coupon.coupon_name=t.data[0].coupon_name,e.coupon.coupon_id=t.data[0].id,e.getCalacOrder()):e.initCoupon())}})},initCoupon:function(){this.coupon.num=0,this.jian_zhe=0,this.coupon_name="",this.coupon_id=""},getCalacOrder:function(){var e=this,t=this.pickupdate.startDate+" "+this.pickupdate.startTime,n=this.pickupdate.endDate+" "+this.pickupdate.endTime;this.$api.sendRequest({url:"/api/car/Order/settlement",data:{car_motorcycle_id:this.id,start_time:t,end_time:n,is_mianya:0==this.payRadio?"否":"是",coupon_users_id:this.coupon.coupon_id,score:0,insure:this.secure_id?this.secureList[this.secureIndex].money:0,songhuan_type:this.songhuan_type},success:function(t){1==t.code?(e.settlement.amount=t.data.amount,e.settlement.yuyuemoney=t.data.yuyuemoney,e.settlement.zuche_deposit=t.data.zuche_deposit,e.settlement.weizhang_deposit=t.data.weizhang_deposit,e.settlement.saleamount=t.data.saleamount,e.settlement.insure=t.data.insure,e.settlement.sever_money=t.data.sever_money,e.settlement.coupon_money=t.data.coupon_money):e.$util.showToast({title:t.msg})}})},getDriverList:function(e){var t=this;this.$api.sendRequest({url:"/api/index.user/driverList",data:{},success:function(n){n.code>=1&&n.data.length&&(t.driverList=n.data,t.driver_id=e||n.data[0].id)}})},changeDriver:function(e){this.getDriverList(e.id),this.showDriver=!1},confirm:function(e){"show"==e.pop?this.show=!1:(this.showExpense=!1,this.submitOrder())},close:function(e){"show"==e.pop?this.show=!1:this.showExpense=!1},changePay:function(e){this.payRadio=e,this.getCalacOrder()},changeSecure:function(e,t){t.id==this.secure_id?(this.secureIndex="",this.secure_id=0,this.insure=0):(this.secureIndex=e,this.secure_id=t.id,this.insure=this.secureList[this.secureIndex].money),this.getCalacOrder()},goDestination:function(){var t="",n="",i="";"自助取还"==this.songhuan_type?(t=this.storeInfo.latitude,n=this.storeInfo.longitude,i=this.storeInfo.address):(t=this.location.latitude,n=this.location.longitude,i=this.location.address),e.openLocation({latitude:parseFloat(t),longitude:parseFloat(n),address:i,success:function(){console.log("导航成功")}})},submitOrder:function(){var e=this,t=this.pickupdate.startDate+" "+this.pickupdate.startTime,n=this.pickupdate.endDate+" "+this.pickupdate.endTime;this.$api.sendRequest({url:"/api/car/Order/createOrder",data:{car_motorcycle_id:this.id,start_time:t,end_time:n,user_driver_id:this.driver_id,is_mianya:0==this.payRadio?"否":"是",coupon_users_id:this.coupon.num>0?this.coupon.coupon_id:0,score:100*this.score_money,long:this.location.longitude,lat:this.location.latitude,address:this.location.address,insure:this.secure_id?this.secureList[this.secureIndex].money:0,remark:this.remark,songhuan_type:this.songhuan_type},success:function(t){if(1==t.code){var n=t.data.order_sn;e.$util.redirectTo("/otherpages/payOrder/payOrder?money="+e.settlement.saleamount+"&order_sn="+n)}else e.$util.showToast({title:t.msg})}})}}};t.default=a}).call(this,n("543d")["default"])},"410f":function(e,t,n){"use strict";(function(e){n("1cde");i(n("66fd"));var t=i(n("bd44"));function i(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},"7b14":function(e,t,n){},a014:function(e,t,n){"use strict";var i=n("7b14"),o=n.n(i);o.a},bd44:function(e,t,n){"use strict";n.r(t);var i=n("f436"),o=n("c9f1");for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);n("a014");var a,r=n("f0c5"),u=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"726f8404",null,!1,i["a"],a);t["default"]=u.exports},c9f1:function(e,t,n){"use strict";n.r(t);var i=n("0b63"),o=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},f436:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i}));var i={uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,"911c"))},"u-Text":function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u--text/u--text")]).then(n.bind(null,"097d"))},uRadioGroup:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-radio-group/u-radio-group")]).then(n.bind(null,"5adf"))},uRadio:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-radio/u-radio")]).then(n.bind(null,"a334"))},coinPop:function(){return n.e("components/coin-pop/coin-pop").then(n.bind(null,"df0f"))},chooseDriver:function(){return n.e("components/choose-driver/choose-driver").then(n.bind(null,"d99c"))},expenseDetail:function(){return n.e("components/expense-detail/expense-detail").then(n.bind(null,"4d38"))},loadingCover:function(){return n.e("components/loading-cover/loading-cover").then(n.bind(null,"3936"))}},o=function(){var e=this,t=e.$createElement,n=(e._self._c,e._f("getDateWeek")(e.pickupdate.startDate)),i=e._f("getDateWeek")(e.pickupdate.endDate);e._isMounted||(e.e0=function(t){return e.$util.redirectTo("/pages/agree/agree?type=6")},e.e1=function(t){e.showDriver=!0},e.e2=function(t){e.showDriver=!0},e.e3=function(t){e.showExpense=!0}),e.$mp.data=Object.assign({},{$root:{f0:n,f1:i}})},s=[]}},[["410f","common/runtime","common/vendor"]]]);